# 実装計画

- [x] プロジェクトのセットアップする
  - [x] React + TypeScript + Viteプロジェクトの作成
  - [x] Tailwind CSSのセットアップ
  - [x] higgsinoライブラリのインストール
  - [x] ESLint/Prettierの設定
  - [x] 型定義とデータ構造の作成

- [x] 画面のモックアップの作成する
  - [x] 開始画面の作成
  - [x] カウントダウン画面の作成
  - [x] プレイ画面の作成
  - [x] 結果画面の作成
  - [x] レスポンシブデザインの基本構造

修正依頼をします。

- 全体: 使用する色は1色にしてシンプルにしてください。カードが浮いているようなデザインの使用を控えてください。
- 開始画面: タイトルと、Spaceキーを教えてスタートだけで問題ありません。
- プレイ画面: 問題文、ひらがな、ローマ字入力、現在の入力などのキャプションは不要です。
- 結果画面: （1分間あたりの入力数）などの補足のテキストは不要です。

- [x] 入力判定ライブラリの使い方をテストを書いて確認する
  - [x] higgsinoライブラリの初期化テスト
  - [x] ひらがな入力の複数パターンテスト（「なつ」→「natsu」「natu」）
  - [x] 正解・不正解判定のテスト
  - [x] 入力進捗管理のテスト
  - [x] ワード完了判定のテスト

- [x] ワードの表示、入力判定機能を実装する
  - [x] ゲーム状態管理（waiting, countdown, playing, result）
  - [x] ワードデータ（20個）の準備
  - [x] 現在のワード表示（漢字混じり文、ひらがな、ローマ字）
  - [x] リアルタイム入力判定処理
  - [x] 入力済み文字のハイライト表示
  - [x] ワード進捗表示（現在/全体）

- [x] カウントダウン機能を実装する
  - [x] 3秒カウントダウンの実装
  - [x] 3→2→1の順序表示
  - [x] カウントダウン終了後の状態遷移
  - [x] タイピング入力の無効化
  - [x] 視覚的に分かりやすい表示デザイン

- [x] リザルトの計算機能を実装する
  - [x] 入力文字数の計算
  - [x] KPM（Keys Per Minute）の算出
  - [x] 正確率の計算
  - [x] 初速の計算（各ワードの最初の正解入力時間）
  - [ ] RKPM（初速を除いたKPM）の計算
  - [x] ワード別詳細結果の生成

スコアの計算がまだ実装できていないですね。初速が変になっている部分があります。リファクタリングの第一歩として、calculateResultsは純粋関数なので別ファイルに抽出することにしましょう。

また、各ワードについて、スコアの計算に必要な情報を持つように変更しましょう。具体的には次の情報が必要です。

- A.ワードを表示した時間
- B.ワードの最初の文字を正解した時間（B-Aが初速）
- C.ワードの最後の文字を正解した時間
- D.ミス数
- E.入力したローマ字列（KPMの計算に必要）

KPMは1分間に入力したキー数なので、(E.length / (C - A)) _ 60です。
RKPMは初速を除いたKPMなので、((E.length - 1) / (C - B)) _ 60です。

- [ ] バグ修正をする
  - [x] 時間の表示がおかしくなることがある
  - [x] 初速が1秒とか2秒になるので計算方法が間違っていると思う
  - [ ] KPMだけじゃなくRKPMも計算してほしい
